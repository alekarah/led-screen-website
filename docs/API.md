# üì° API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

> –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ LED Screen Website

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è](#–æ–±—â–∞—è-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
- [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [–ü—É–±–ª–∏—á–Ω—ã–µ API](#–ø—É–±–ª–∏—á–Ω—ã–µ-api)
- [–ê–¥–º–∏–Ω API: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#–∞–¥–º–∏–Ω-api-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- [–ê–¥–º–∏–Ω API: –ü—Ä–æ–µ–∫—Ç—ã](#–∞–¥–º–∏–Ω-api-–ø—Ä–æ–µ–∫—Ç—ã)
- [–ê–¥–º–∏–Ω API: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è](#–∞–¥–º–∏–Ω-api-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- [–ê–¥–º–∏–Ω API: –ö–æ–Ω—Ç–∞–∫—Ç—ã](#–∞–¥–º–∏–Ω-api-–∫–æ–Ω—Ç–∞–∫—Ç—ã)
- [–ê–¥–º–∏–Ω API: –ó–∞–º–µ—Ç–∫–∏](#–∞–¥–º–∏–Ω-api-–∑–∞–º–µ—Ç–∫–∏)
- [–ê–¥–º–∏–Ω API: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞](#–∞–¥–º–∏–Ω-api-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
- [–ö–æ–¥—ã –æ—à–∏–±–æ–∫](#–∫–æ–¥—ã-–æ—à–∏–±–æ–∫)

---

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**Base URL**: `http://localhost:8080` (development) / `https://yourdomain.com` (production)

**–§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö**:
- Request: `application/json` –∏–ª–∏ `multipart/form-data` (–¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤)
- Response: `application/json` –∏–ª–∏ `text/html` (–¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü)

**–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å**: Europe/Moscow (MSK, UTC+3)

**–ö–æ–¥–∏—Ä–æ–≤–∫–∞**: UTF-8

---

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ê–¥–º–∏–Ω—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã JWT —Ç–æ–∫–µ–Ω–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ HTTP-only cookies.

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

**Endpoint**: `POST /admin/login`
**Auth**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Request** (form-data):
```
username: string (required)
password: string (required)
```

**Response** (HTML redirect):
```
302 Found
Location: /admin/
Set-Cookie: admin_token=<JWT>; Path=/; HttpOnly; Max-Age=604800
```

**Errors**:
- `401`: –ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å
- `401`: –ê–∫–∫–∞—É–Ω—Ç –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `/admin/*` (–∫—Ä–æ–º–µ `/admin/login`) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç JWT —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ middleware:
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ cookie `admin_token`
2. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ –∏ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ `admin_id` –∏ `admin_username` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞

**JWT Claims —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
```json
{
  "user_id": 1,
  "username": "admin",
  "exp": 1234567890,
  "iat": 1234567890,
  "iss": "ledsite-admin"
}
```

### –í—ã—Ö–æ–¥

**Endpoint**: `GET /admin/logout`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Response**:
```
302 Found
Location: /admin/login
Set-Cookie: admin_token=; Path=/; HttpOnly; Max-Age=-1
```

---

## –ü—É–±–ª–∏—á–Ω—ã–µ API

### 1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤

**Endpoint**: `GET /api/projects`
**Auth**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Query Parameters**:
| –ü–∞—Ä–∞–º–µ—Ç—Ä   | –¢–∏–ø     | –û–ø–∏—Å–∞–Ω–∏–µ                      | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|---------|-------------------------------|--------------|
| `page`     | integer | –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã                | 1            |
| `limit`    | integer | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ        | 12           |
| `category` | string  | Slug –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ | -            |

**Response** (200 OK):
```json
{
  "projects": [
    {
      "id": 1,
      "title": "LED —ç–∫—Ä–∞–Ω –Ω–∞ –¢–¶ –ú–µ–≥–∞",
      "slug": "led-ekran-na-tc-mega-1234567890",
      "description": "–ú–æ–Ω—Ç–∞–∂ —É–ª–∏—á–Ω–æ–≥–æ LED —ç–∫—Ä–∞–Ω–∞...",
      "location": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
      "size": "12x5",
      "pixel_pitch": "P6.66",
      "completed": true,
      "featured": true,
      "view_count": 156,
      "sort_order": 1,
      "created_at": "2024-01-15T10:30:00Z",
      "updated_at": "2024-01-20T14:25:00Z",
      "categories": [
        {
          "id": 1,
          "name": "–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã",
          "slug": "shopping-centers",
          "description": "–≠–∫—Ä–∞–Ω—ã –¥–ª—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤"
        }
      ],
      "images": [
        {
          "id": 1,
          "project_id": 1,
          "filename": "project_1_1705312800_0.jpg",
          "file_path": "../frontend/static/uploads/project_1_1705312800_0.jpg",
          "file_size": 2048576,
          "mime_type": "image/jpeg",
          "alt": "",
          "caption": "",
          "sort_order": 0,
          "crop_x": 50.0,
          "crop_y": 50.0,
          "crop_scale": 1.0,
          "created_at": "2024-01-15T10:35:00Z"
        }
      ]
    }
  ],
  "total": 25,
  "page": 1,
  "limit": 12
}
```

### 2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É

**Endpoint**: `POST /api/contact`
**Auth**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Request** (JSON):
```json
{
  "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
  "phone": "+7 (921) 123-45-67",
  "email": "ivan@example.com",
  "company": "–û–û–û –ü—Ä–∏–º–µ—Ä",
  "project_type": "–£–ª–∏—á–Ω—ã–π LED —ç–∫—Ä–∞–Ω",
  "message": "–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å LED —ç–∫—Ä–∞–Ω —Ä–∞–∑–º–µ—Ä–æ–º 10x5 –º–µ—Ç—Ä–æ–≤..."
}
```

**Validation**:
- `name` (required): –º–∏–Ω–∏–º—É–º 1 —Å–∏–º–≤–æ–ª
- `phone` (required): –º–∏–Ω–∏–º—É–º 1 —Å–∏–º–≤–æ–ª
- `email` (optional): –≤–∞–ª–∏–¥–Ω—ã–π email
- `company` (optional)
- `project_type` (optional)
- `message` (optional)

**Response** (200 OK):
```json
{
  "message": "–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è."
}
```

**Errors**:
- `400`: –ò–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
- `500`: –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏

### 3. –¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

**Endpoint**: `POST /api/track/project-view/:id`
**Auth**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –ø—Ä–æ–µ–∫—Ç–∞

**Response** (200 OK):
```json
{
  "ok": true
}
```

**Errors**:
- `400`: invalid project id
- `404`: project not found
- `500`: db error

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**:
- –ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –ø–æ –¥–Ω—è–º (UTC)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç UPSERT –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞ —Å—á–µ—Ç—á–∏–∫–∞
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `project_view_dailies`

### 4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫ –∑–∞ 7 –¥–Ω–µ–π

**Endpoint**: `GET /api/admin/contacts-7d`
**Auth**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Response** (200 OK):
```json
[
  {"day": "2024-11-01", "count": 3},
  {"day": "2024-11-02", "count": 5},
  {"day": "2024-11-03", "count": 2},
  {"day": "2024-11-04", "count": 7},
  {"day": "2024-11-05", "count": 4},
  {"day": "2024-11-06", "count": 6},
  {"day": "2024-11-07", "count": 8}
]
```

---

## –ê–¥–º–∏–Ω API: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### 1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞

**Endpoint**: `GET /admin/login`
**Auth**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Response**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–æ—Ä–º–æ–π –≤—Ö–æ–¥–∞

### 2. –í—Ö–æ–¥

–°–º. —Ä–∞–∑–¥–µ–ª [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)

### 3. –í—ã—Ö–æ–¥

–°–º. —Ä–∞–∑–¥–µ–ª [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)

---

## –ê–¥–º–∏–Ω API: –ü—Ä–æ–µ–∫—Ç—ã

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (cookie `admin_token`).

### 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

**Endpoint**: `POST /admin/projects`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Request** (form-data):
```
title: string (required)
description: string
location: string
size: string
pixel_pitch: string
featured: string ("on" –¥–ª—è true)
categories: array of integer (category IDs)
```

**Response** (200 OK):
```json
{
  "message": "–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω",
  "project_id": 15
}
```

**Errors**:
- `500`: –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**:
- Slug –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `title` —Å —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏–µ–π
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å slug –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —Å—É—Ñ—Ñ–∏–∫—Å–æ–º (timestamp –∏–ª–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç)

### 2. –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

**Endpoint**: `GET /admin/projects/:id`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –ø—Ä–æ–µ–∫—Ç–∞

**Response** (200 OK):
```json
{
  "project": {
    "id": 1,
    "title": "LED —ç–∫—Ä–∞–Ω –Ω–∞ –¢–¶ –ú–µ–≥–∞",
    "slug": "led-ekran-na-tc-mega-1234567890",
    "description": "–ú–æ–Ω—Ç–∞–∂ —É–ª–∏—á–Ω–æ–≥–æ LED —ç–∫—Ä–∞–Ω–∞...",
    "location": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "size": "12x5",
    "pixel_pitch": "P6.66",
    "completed": true,
    "featured": true,
    "view_count": 156,
    "sort_order": 1,
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-20T14:25:00Z",
    "categories": [...],
    "images": [...]
  },
  "categories": [
    {"id": 1, "name": "–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã", "slug": "shopping-centers"},
    {"id": 2, "name": "–†–µ–∫–ª–∞–º–Ω—ã–µ —â–∏—Ç—ã", "slug": "billboards"}
  ]
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `404`: –ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

**Headers**:
```
Cache-Control: no-store, no-cache, must-revalidate, max-age=0
Pragma: no-cache
Expires: 0
```

### 3. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

**Endpoint**: `POST /admin/projects/:id/update`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –ø—Ä–æ–µ–∫—Ç–∞

**Request** (form-data):
```
title: string
description: string
location: string
size: string
pixel_pitch: string
featured: string ("on" –¥–ª—è true)
categories: array of integer (category IDs)
```

**Response** (200 OK):
```json
{
  "message": "–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `404`: –ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500`: –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### 4. –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

**Endpoint**: `DELETE /admin/projects/:id`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –ø—Ä–æ–µ–∫—Ç–∞

**Response** (200 OK):
```json
{
  "message": "–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `404`: –ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500`: –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**:
- –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
  - –°–≤—è–∑–∏ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (project_categories)
  - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –ë–î –∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ (project_view_dailies)

### 5. –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞

**Endpoint**: `POST /admin/projects/:id/reorder`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –ø—Ä–æ–µ–∫—Ç–∞

**Request** (form-data):
```
position: integer
```

**Response** (200 OK):
```json
{
  "message": "–ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id / –ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
- `404`: –ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500`: –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞

### 6. –ú–∞—Å—Å–æ–≤–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤

**Endpoint**: `POST /admin/projects/bulk-reorder`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Request** (JSON):
```json
{
  "projects": [
    {"id": 1, "sort_order": 0},
    {"id": 5, "sort_order": 1},
    {"id": 3, "sort_order": 2},
    {"id": 2, "sort_order": 3}
  ]
}
```

**Response** (200 OK):
```json
{
  "message": "–ü–æ—Ä—è–¥–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω"
}
```

**Errors**:
- `400`: –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ / –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
- `500`: –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏

### 7. –°–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤

**Endpoint**: `POST /admin/projects/reset-order`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Response** (200 OK):
```json
{
  "message": "–ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å–±—Ä–æ—à–µ–Ω –∫ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º—É"
}
```

**Errors**:
- `500`: –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –ø–æ—Ä—è–¥–∫–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–µ–∫—Ç—ã –ø–æ `title ASC` –∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç `sort_order` –æ—Ç 0

### 8. –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

**Endpoint**: `POST /admin/projects/:id/reset-views`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –ø—Ä–æ–µ–∫—Ç–∞

**Response** (200 OK):
```json
{
  "ok": true
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `500`: –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

---

## –ê–¥–º–∏–Ω API: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

### 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**Endpoint**: `POST /admin/upload-images`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Request** (multipart/form-data):
```
project_id: integer (required)
images: file[] (multiple files)
```

**Supported formats**: `.jpg`, `.jpeg`, `.png`, `.gif`, `.webp`

**Response** (200 OK):
```json
{
  "message": "–ó–∞–≥—Ä—É–∂–µ–Ω–æ 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π",
  "images": [
    {
      "id": 10,
      "project_id": 5,
      "filename": "project_5_1705312800_0.jpg",
      "original_name": "photo1.jpg",
      "file_path": "../frontend/static/uploads/project_5_1705312800_0.jpg",
      "file_size": 2048576,
      "mime_type": "image/jpeg",
      "sort_order": 0,
      "crop_x": 50.0,
      "crop_y": 50.0,
      "crop_scale": 1.0,
      "created_at": "2024-01-15T10:35:00Z"
    }
  ]
}
```

**Errors**:
- `400`: –ù–µ–≤–µ—Ä–Ω—ã–π ID –ø—Ä–æ–µ–∫—Ç–∞ / –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤
- `404`: –ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**:
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `../frontend/static/uploads/`
- –ò–º–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ `project_{id}_{timestamp}_{index}{ext}`
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 10MB (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ config)

### 2. –£–¥–∞–ª–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

**Endpoint**: `DELETE /admin/images/:id`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**Response** (200 OK):
```json
{
  "message": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `404`: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –£–¥–∞–ª—è–µ—Ç—Å—è –∫–∞–∫ –∑–∞–ø–∏—Å—å –≤ –ë–î, —Ç–∞–∫ –∏ —Ñ–∞–π–ª –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### 3. –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—Ä–æ–ø–ø–∏–Ω–≥–∞

**Endpoint**: `POST /admin/images/:id/crop`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**Request** (JSON):
```json
{
  "crop_x": 45.5,
  "crop_y": 60.0,
  "crop_scale": 1.2
}
```

**Validation**:
- `crop_x`: 0-100 (default: 50)
- `crop_y`: 0-100 (default: 50)
- `crop_scale`: 0.5-3.0 (default: 1.0)

**Response** (200 OK):
```json
{
  "image": {
    "id": 10,
    "project_id": 5,
    "filename": "project_5_1705312800_0.jpg",
    "crop_x": 45.5,
    "crop_y": 60.0,
    "crop_scale": 1.2,
    ...
  }
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id / –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–æ–ø–ø–∏–Ω–≥–∞
- `404`: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
- `500`: –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

## –ê–¥–º–∏–Ω API: –ö–æ–Ω—Ç–∞–∫—Ç—ã

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

### 1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

**Endpoint**: `GET /admin/contacts`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Query Parameters**:
| –ü–∞—Ä–∞–º–µ—Ç—Ä   | –¢–∏–ø     | –û–ø–∏—Å–∞–Ω–∏–µ                               | –ó–Ω–∞—á–µ–Ω–∏—è                       |
|------------|---------|----------------------------------------|--------------------------------|
| `page`     | integer | –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã                         | default: 1                     |
| `limit`    | integer | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ                 | default: 25                    |
| `search`   | string  | –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/—Ç–µ–ª–µ—Ñ–æ–Ω—É/email/–∫–æ–º–ø–∞–Ω–∏–∏ | -                              |
| `status`   | string  | –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É                      | `new`, `processed`             |
| `date`     | string  | –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ                         | `today`, `7d`, `month`         |
| `reminder` | string  | –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º                 | `today`, `overdue`, `upcoming` |

**Response**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π –∑–∞—è–≤–æ–∫

### 2. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞—Ä—Ö–∏–≤–∞

**Endpoint**: `GET /admin/contacts/archive`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Query Parameters**: –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `/admin/contacts` (–∫—Ä–æ–º–µ `status`)

**Response**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∞—Ä—Ö–∏–≤–Ω—ã–º–∏ –∑–∞—è–≤–∫–∞–º–∏

### 3. –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV

**Endpoint**: `GET /admin/contacts/export.csv`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Query Parameters**:
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏–∑ `/admin/contacts`
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏

**Response** (200 OK):
```
Content-Type: text/csv; charset=utf-8
Content-Disposition: attachment; filename="contacts_export_20241102_153045.csv"

–ò–º—è;–¢–µ–ª–µ—Ñ–æ–Ω;Email;–ö–æ–º–ø–∞–Ω–∏—è;–¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞;–°–æ–æ–±—â–µ–Ω–∏–µ;–°—Ç–∞—Ç—É—Å;–î–∞—Ç–∞
–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤;+7 (921) 123-45-67;ivan@example.com;–û–û–û –ü—Ä–∏–º–µ—Ä;–£–ª–∏—á–Ω—ã–π LED —ç–∫—Ä–∞–Ω;...;new;15.01.2024 10:30
```

**Format**:
- Encoding: UTF-8 with BOM
- Delimiter: `;` (semicolon)
- Date format: `DD.MM.YYYY HH:MM` (Europe/Moscow)

### 4. –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏

**Endpoint**: `POST /admin/contacts/:id/status`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏

**Request** (JSON):
```json
{
  "status": "processed"
}
```

**Allowed values**: `new`, `processed`, `archived`

**Response** (200 OK):
```json
{
  "message": "–°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—ë–Ω",
  "status": "processed"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id / –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ / –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å—Ç–∞—Ç—É—Å
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞—è–≤–∫—É

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ `archived` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `archived_at`

### 5. –ú–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

**Endpoint**: `POST /admin/contacts/bulk`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Request** (JSON):
```json
{
  "action": "processed",
  "ids": [1, 5, 12, 18]
}
```

**Allowed actions**: `new`, `processed`, `archived`

**Response** (200 OK):
```json
{
  "success": true,
  "action": "processed",
  "ids": [1, 5, 12, 18]
}
```

**Errors**:
- `400`: –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ / –ù–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞—è–≤–∫–∏

### 6. –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∑–∞—è–≤–∫—É

**Endpoint**: `PATCH /admin/contacts/:id/archive`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏

**Response** (200 OK):
```json
{
  "message": "–í –∞—Ä—Ö–∏–≤–µ",
  "status": "archived"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `status=archived` –∏ `archived_at=NOW()`

### 7. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –∞—Ä—Ö–∏–≤–∞

**Endpoint**: `PATCH /admin/contacts/:id/restore`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏

**Request** (JSON, optional):
```json
{
  "to": "processed"
}
```

**Allowed values**: `new` (default), `processed`

**Response** (200 OK):
```json
{
  "message": "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ",
  "status": "new"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `archived_at=NULL`

### 8. –£–¥–∞–ª–∏—Ç—å –∑–∞—è–≤–∫—É

**Endpoint**: `DELETE /admin/contacts/:id`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏

**Query Parameters**:
- `hard` (string): `true`/`1`/`yes` –¥–ª—è –∂–µ—Å—Ç–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è

**Response** (200 OK):

**Soft delete** (default):
```json
{
  "message": "–í –∞—Ä—Ö–∏–≤–µ",
  "status": "archived"
}
```

**Hard delete** (`?hard=true`):
```json
{
  "message": "–£–¥–∞–ª–µ–Ω–æ"
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å / –ù–µ —É–¥–∞–ª–æ—Å—å –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å

---

## –ê–¥–º–∏–Ω API: –ó–∞–º–µ—Ç–∫–∏

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

### 1. –ü–æ–ª—É—á–∏—Ç—å –∑–∞–º–µ—Ç–∫–∏ –∑–∞—è–≤–∫–∏

**Endpoint**: `GET /admin/contacts/:id/notes`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏

**Response** (200 OK):
```json
{
  "notes": [
    {
      "id": 5,
      "contact_id": 10,
      "text": "–ö–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª, –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è —Ü–µ–Ω–∞–º–∏",
      "author": "–ò–≤–∞–Ω",
      "created_at": "2024-11-02T14:30:00Z"
    },
    {
      "id": 6,
      "contact_id": 10,
      "text": "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ö–ü",
      "author": "–ü–µ—Ç—Ä",
      "created_at": "2024-11-03T10:15:00Z"
    }
  ]
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∑–∞–º–µ—Ç–∫–∏

**Sorting**: –ü–æ `created_at DESC` (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)

### 2. –°–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É

**Endpoint**: `POST /admin/contacts/:id/notes`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏

**Request** (JSON):
```json
{
  "text": "–ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∑–∞–∫–∞–∑",
  "author": "–ò–≤–∞–Ω"
}
```

**Validation**:
- `text` (required): –º–∏–Ω–∏–º—É–º 1 —Å–∏–º–≤–æ–ª
- `author` (optional): –∏–º—è –∞–≤—Ç–æ—Ä–∞

**Response** (200 OK):
```json
{
  "note": {
    "id": 7,
    "contact_id": 10,
    "text": "–ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∑–∞–∫–∞–∑",
    "author": "–ò–≤–∞–Ω",
    "created_at": "2024-11-05T16:20:00Z"
  }
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id / –¢–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É

### 3. –£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É

**Endpoint**: `DELETE /admin/contacts/:id/notes/:note_id`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏
- `note_id` (integer): ID –∑–∞–º–µ—Ç–∫–∏

**Response** (200 OK):
```json
{
  "message": "–ó–∞–º–µ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∞",
  "id": 7
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id / –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id –∑–∞–º–µ—Ç–∫–∏
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É

**Security**: –£–¥–∞–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∑–∞–º–µ—Ç–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—è–≤–∫–µ

### 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ

**Endpoint**: `PATCH /admin/contacts/:id/reminder`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**URL Parameters**:
- `id` (integer): ID –∑–∞—è–≤–∫–∏

**Request** (JSON):
```json
{
  "remind_at": "2024-11-10 15:00",
  "remind_flag": true
}
```

**Formats**:
- RFC3339: `2024-11-10T15:00:00+03:00`
- Local (MSK): `2024-11-10 15:00`
- –î–ª—è –æ—á–∏—Å—Ç–∫–∏: `remind_at: ""`

**Response** (200 OK):
```json
{
  "message": "–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ",
  "remind_at": "2024-11-10T12:00:00Z",
  "remind_flag": true
}
```

**Errors**:
- `400`: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id / –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ / –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
- `500`: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**:
- –í—Ä–µ–º—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ UTC
- `remind_flag` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ
- –ï—Å–ª–∏ `remind_at` –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ - –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ—á–∏—â–∞–µ—Ç—Å—è

---

## –ê–¥–º–∏–Ω API: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

### 1. Dashboard

**Endpoint**: `GET /admin/`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Response**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –¥–∞—à–±–æ—Ä–¥–æ–º

**Data included**:
- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–ø—Ä–æ–µ–∫—Ç—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∑–∞—è–≤–∫–∏)
- –ó–∞—è–≤–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (—Å–µ–≥–æ–¥–Ω—è, –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ)
- –¢–æ–ø-5 –ø—Ä–æ–µ–∫—Ç–æ–≤ –∑–∞ 30 –¥–Ω–µ–π
- –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∑–∞ 30 –¥–Ω–µ–π
- –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (DB status, environment, –≤–µ—Ä—Å–∏—è)

### 2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫ –∑–∞ 7 –¥–Ω–µ–π

**Endpoint**: `GET /api/admin/contacts-7d`
**Auth**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π)

–°–º. —Ä–∞–∑–¥–µ–ª [–ü—É–±–ª–∏—á–Ω—ã–µ API](#–ø—É–±–ª–∏—á–Ω—ã–µ-api)

### 3. –°–±—Ä–æ—Å–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤

**Endpoint**: `POST /admin/analytics/reset`
**Auth**: —Ç—Ä–µ–±—É–µ—Ç—Å—è

**Response** (200 OK):
```json
{
  "ok": true
}
```

**Errors**:
- `500`: –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í—ã–ø–æ–ª–Ω—è–µ—Ç `TRUNCATE TABLE project_view_dailies RESTART IDENTITY`

---

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

### HTTP Status Codes

| –ö–æ–¥   | –û–ø–∏—Å–∞–Ω–∏–µ              | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ                           |
|-------|-----------------------|--------------------------------------|
| `200` | OK                    | –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å                      |
| `302` | Found                 | –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/–≤—ã—Ö–æ–¥–∞    |
| `400` | Bad Request           | –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è        |
| `401` | Unauthorized          | –ù–µ–≤–µ—Ä–Ω—ã–µ credentials, –∏—Å—Ç–µ–∫—à–∏–π —Ç–æ–∫–µ–Ω |
| `404` | Not Found             | –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω                     |
| `500` | Internal Server Error | –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã |

### Error Response Format

–í—Å–µ –æ—à–∏–±–∫–∏ API –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:

```json
{
  "error": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
}
```

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫

**–í–∞–ª–∏–¥–∞—Ü–∏—è**:
```json
{
  "error": "–ò–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"
}
```

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**:
```json
{
  "error": "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å"
}
```

**–ù–µ –Ω–∞–π–¥–µ–Ω–æ**:
```json
{
  "error": "–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"
}
```

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**:
```json
{
  "error": "–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞: duplicate key value violates unique constraint"
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### JavaScript (Fetch API)

**–ü—É–±–ª–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã)**:
```javascript
const response = await fetch('/api/projects?page=1&limit=12&category=shopping-centers');
const data = await response.json();
console.log(data.projects);
```

**–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏**:
```javascript
const response = await fetch('/api/contact', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({
    name: '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤',
    phone: '+7 (921) 123-45-67',
    email: 'ivan@example.com',
    message: '–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å LED —ç–∫—Ä–∞–Ω'
  })
});
const result = await response.json();
alert(result.message);
```

**–ê–¥–º–∏–Ω—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å (–æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å)**:
```javascript
const response = await fetch('/admin/contacts/10/status', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  credentials: 'include',  // –í–∞–∂–Ω–æ –¥–ª—è JWT cookie!
  body: JSON.stringify({status: 'processed'})
});
const data = await response.json();
console.log(data.message);
```

**–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**:
```javascript
const formData = new FormData();
formData.append('project_id', '5');
formData.append('images', file1);
formData.append('images', file2);

const response = await fetch('/admin/upload-images', {
  method: 'POST',
  credentials: 'include',
  body: formData
});
const result = await response.json();
console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${result.images.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`);
```

### cURL

**–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã**:
```bash
curl -X GET "http://localhost:8080/api/projects?page=1&limit=12"
```

**–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É**:
```bash
curl -X POST http://localhost:8080/api/contact \
  -H "Content-Type: application/json" \
  -d '{"name":"–ò–≤–∞–Ω","phone":"+79211234567","email":"ivan@example.com"}'
```

**–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å (–∞–¥–º–∏–Ω)**:
```bash
curl -X POST http://localhost:8080/admin/contacts/10/status \
  -H "Content-Type: application/json" \
  -H "Cookie: admin_token=YOUR_JWT_TOKEN" \
  -d '{"status":"processed"}'
```

---

## Rate Limiting

**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è**: Rate limiting –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production**:
- –î–æ–±–∞–≤–∏—Ç—å middleware –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ª–∏–º–∏—Ç—ã:
  - –ü—É–±–ª–∏—á–Ω—ã–µ API: 100 req/min per IP
  - –ê–¥–º–∏–Ω API: 300 req/min per token
  - –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏: 5 req/hour per IP

---

## Changelog API

**v1.0.0** (–ù–æ—è–±—Ä—å 2024):
- –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑ API
- –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∑–∞—è–≤–æ–∫
- –ê–¥–º–∏–Ω API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –°–∏—Å—Ç–µ–º–∞ –∑–∞–º–µ—Ç–æ–∫ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ù–æ—è–±—Ä—å 2024

